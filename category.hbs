{{!< default}}

{{> "components/search-form"}}

{{!-- ヘッダーセクション: 親タグページまたは子タグページ --}}
<div id="cat_header">
    {{> "components/breadcrumb"}}

    {{#tag}}
        {{!-- 親タグページ（data: tag.slug が設定されている） --}}
        {{#get "pages" filter="slug:{{slug}}" limit="1"}}
            {{#foreach pages}}
                {{> "category-header"}}
            {{/foreach}}
        {{/get}}
    {{else}}
        {{!-- 子タグページ（最初の投稿からタグ情報を取得） --}}
        {{#foreach posts limit="1"}}
            {{#foreach tags limit="1"}}
                {{#get "pages" filter="slug:women-magazine-{{slug}},slug:women-manga-{{slug}}" limit="1"}}
                    {{#foreach pages}}
                        {{> "category-header"}}
                    {{/foreach}}
                {{/get}}
            {{/foreach}}
        {{/foreach}}
    {{/tag}}
</div>

<div class="gh-content-wrapper">
    <main class="gh-main-content">
        {{!-- タイトルセクション: 親タグページまたは子タグページ --}}
        {{#tag}}
            {{!-- 親タグページ --}}
            <h2>{{name}}（発売日順）</h2>
        {{else}}
            {{!-- 子タグページ --}}
            {{#foreach posts limit="1"}}
                {{#foreach tags limit="1"}}
                    {{#get "pages" filter="slug:women-magazine-{{slug}},slug:women-manga-{{slug}}" limit="1" as |page_result|}}
                        {{#if page_result}}
                            {{#foreach page_result}}
                                <h2>{{title}}（発売日順）</h2>
                            {{/foreach}}
                        {{/if}}
                    {{/get}}
                {{/foreach}}
            {{/foreach}}
        {{/tag}}

        {{!-- 投稿セクション: routes.yamlのfilterから直接postsを利用 --}}
        <div class="post-grid category-post-list">
            {{#foreach posts}}
                {{> "post-card"}}
            {{/foreach}}
        </div>

        {{> "pagination"}}
    </main>

    {{> "sidebar"}}
</div>
